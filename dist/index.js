import{onHide as n,onUnload as t,onLaunch as r,onLoad as e,onShow as u}from"@dcloudio/uni-app";import{onUnmounted as o,onMounted as i}from"vue";var c;!function(n){n.PEDDING="pedding",n.FULFILLED="fulfilled"}(c||(c={}));var s={},a={},f={};function l(n){return new Promise((function(t,r){f[n.key]={status:c.PEDDING,resolve:t,onUpdate:n.onUpdate}}))}var v=function(n){return new Proxy(n,{get:function(n,t){return t in n?n[t]:void 0},set:function(n,t,r){var e,u;(n[t]=r,f[t]&&f[t].status==c.PEDDING)&&(f[t].onUpdate?(null===(u=(e=f[t]).onUpdate)||void 0===u?void 0:u.call(e,r))&&(f[t].status=c.FULFILLED,f[t].resolve(r)):(f[t].status=c.FULFILLED,f[t].resolve(r)));return!0}})};function h(n,t){s=Object.assign({},n);for(var r=0,e=Object.keys(n).map((function(t){return n[t]}));r<e.length;r++){var u=e[r];a[u.key]=l(u)}}function p(n,t,r,e){return new(r||(r=Promise))((function(u,o){function i(n){try{s(e.next(n))}catch(n){o(n)}}function c(n){try{s(e.throw(n))}catch(n){o(n)}}function s(n){var t;n.done?u(n.value):(t=n.value,t instanceof r?t:new r((function(n){n(t)}))).then(i,c)}s((e=e.apply(n,t||[])).next())}))}function d(n,t){var r,e,u,o,i={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(c){return function(s){return function(c){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(i=0)),i;)try{if(r=1,e&&(u=2&c[0]?e.return:c[0]?e.throw||((u=e.return)&&u.call(e),0):e.next)&&!(u=u.call(e,c[1])).done)return u;switch(e=0,u&&(c=[2&c[0],u.value]),c[0]){case 0:case 1:u=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,e=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(u=i.trys,(u=u.length>0&&u[u.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!u||c[1]>u[0]&&c[1]<u[3])){i.label=c[1];break}if(6===c[0]&&i.label<u[1]){i.label=u[1],u=c;break}if(u&&i.label<u[2]){i.label=u[2],i.ops.push(c);break}u[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(n,i)}catch(n){c=[6,n],e=0}finally{r=u=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}}"function"==typeof SuppressedError&&SuppressedError;var x=function(r,e,o){var i=u;o&&n(o),o&&t(o),i((function(){r(),null==e||e()}))},y={};function m(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(n){var t=16*Math.random()|0;return("x"==n?t:3&t|8).toString(16)}))}function b(n,t){return Array.isArray(n)||(n=[n]),n.join("-")+"-".concat(t)}function w(n,t){var r=y[b(n,t)];r&&(r.reject(),delete y[b(n,t)])}function L(n,t,r){var e=b(n,t);y[e]={},y[e].promise=new Promise((function(n,t){y[e].reject=t}));var u=function(n,t){var r=[];return Array.isArray(n)||(n=[n]),(n||[]).forEach((function(n){n in s?r.push(n):console.error({methods:t,key:n,error:"监听的值未注册，请检查init方法"})})),r}(n,r),o=u.map((function(n){var t=s[n].key;return f[t].status==c.FULFILLED?Promise.resolve:a[t]}));return Promise.race([Promise.all(o),y[e].promise])}var E=function(t,e){var u=this,o=m();!function(t,e,u){var o=r;u&&n(u),o((function(n){t(n),null==e||e(n)}))}((function(n){}),(function(n){return p(u,void 0,void 0,(function(){return d(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,L(e,o,"onCustomLaunch")];case 1:return r.sent(),t(n),[3,3];case 2:return r.sent(),[3,3];case 3:return[2]}}))}))}),(function(){w(e,o)}))},D=function(n,r){var u=this,o=m();!function(n,r,u){var o=e;u&&t(u),o((function(t){n(t),null==r||r(t)}))}((function(n){}),(function(t){return p(u,void 0,void 0,(function(){return d(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,L(r,o,"onCustomLoad")];case 1:return e.sent(),n(t),[3,3];case 2:return e.sent(),[3,3];case 3:return[2]}}))}))}),(function(){w(r,o)}))},P=function(n,t){var r=this,e=m();x((function(n){}),(function(){return p(r,void 0,void 0,(function(){return d(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,L(t,e,"onCustomShow")];case 1:return r.sent(),n(),[3,3];case 2:return r.sent(),[3,3];case 3:return[2]}}))}))}),(function(){w(t,e)}))},g=function(n,r){var e=this,u=m();!function(n,r,e){n(),null==r||r(),e&&o(e),e&&t(e)}((function(n){}),(function(){return p(e,void 0,void 0,(function(){return d(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,L(r,u,"onCustomCreated")];case 1:return t.sent(),n(),[3,3];case 2:return t.sent(),[3,3];case 3:return[2]}}))}))}),(function(){w(r,u)}))},k=function(n,t){var r=this,e=m();!function(n,t,r){var e=i;r&&o(r),e((function(){n(),null==t||t()}))}((function(n){}),(function(){return p(r,void 0,void 0,(function(){return d(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,L(t,e,"onCustomMounted")];case 1:return r.sent(),n(),[3,3];case 2:return r.sent(),[3,3];case 3:return[2]}}))}))}),(function(){w(t,e)}))},F=function(n,t){var r=this,e=m();x((function(n){}),(function(){return p(r,void 0,void 0,(function(){return d(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,L(t,e,"onCustomReady")];case 1:return r.sent(),n(),[3,3];case 2:return r.sent(),[3,3];case 3:return[2]}}))}))}),(function(){w(t,e)}))};export{h as init,a as keyPromise,g as onCustomCreated,E as onCustomLaunch,D as onCustomLoad,k as onCustomMounted,F as onCustomReady,P as onCustomShow,f as promiseMap,v as proxyData,s as watchObj};
