import{onHide as n,onUnload as t,onLaunch as e,onLoad as r,onShow as o}from"@dcloudio/uni-app";import{onUnmounted as u,onMounted as c}from"vue";var i,a=function(){return a=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n},a.apply(this,arguments)};function s(n,t,e,r){return new(e||(e=Promise))((function(o,u){function c(n){try{a(r.next(n))}catch(n){u(n)}}function i(n){try{a(r.throw(n))}catch(n){u(n)}}function a(n){var t;n.done?o(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(c,i)}a((r=r.apply(n,t||[])).next())}))}function f(n,t){var e,r,o,u,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function i(i){return function(a){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;u&&(u=0,i[0]&&(c=0)),c;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=c.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(n,c)}catch(n){i=[6,n],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}"function"==typeof SuppressedError&&SuppressedError,function(n){n.PEDDING="pedding",n.FULFILLED="fulfilled"}(i||(i={}));var l={},p={},v={};function h(n){return new Promise((function(t,e){v[n.key]={status:i.PEDDING,resolve:t,onUpdate:n.onUpdate}}))}function y(n,t,e){var r=e?"".concat(e,".").concat(n):n,o=[r];"object"==typeof t&&null!==t&&Object.keys(t).forEach((function(n){o.push("".concat(r,".").concat(n))})),o.forEach((function(n){var e,r;if(v[n])if(v[n].onUpdate){var o=null===(r=(e=v[n]).onUpdate)||void 0===r?void 0:r.call(e,t);o&&v[n].status==i.PEDDING?(v[n].status=i.FULFILLED,v[n].resolve(t)):o||v[n].status!=i.FULFILLED||(p[n]=h({key:n,onUpdate:v[n].onUpdate}))}else t&&v[n].status==i.PEDDING?(v[n].status=i.FULFILLED,v[n].resolve(t)):t||v[n].status!=i.FULFILLED||(p[n]=h({key:n,onUpdate:v[n].onUpdate}))}))}var d=function(n){return new Proxy(n,{get:function(t,e,r){var o=Reflect.get(n,e,r);return"object"==typeof o&&null!==o?d(a({_parentTarget:e},o)):(y(e,o,t._parentTarget?t._parentTarget:null),o)},set:function(n,t,e){return n[t]=e,y(t,e,n._parentTarget?n._parentTarget:null),!0}})};function x(n,t){l=Object.assign({},n);for(var e=0,r=Object.keys(n).map((function(t){return n[t]}));e<r.length;e++){var o=r[e];o.key="pinia"==o.type?"pinia-".concat(o.key):o.key,p[o.key]=h(o)}t&&t.$subscribe((function(n){var t=n.events.key,e=n.events.newValue;y("pinia-".concat(t),e)}))}var b=function(e,r,u){var c=o;u&&n(u),u&&t(u),c((function(){e(),null==r||r()}))},m={};function w(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(n){var t=16*Math.random()|0;return("x"==n?t:3&t|8).toString(16)}))}function L(n,t){return Array.isArray(n)||(n=[n]),n.join("-")+"-".concat(t)}function g(n,t){var e=m[L(n,t)];e&&(e.reject(),delete m[L(n,t)])}function k(n,t,e){var r=L(n,t);m[r]={},m[r].promise=new Promise((function(n,t){m[r].reject=t}));var o=function(n,t){var e=[];return Array.isArray(n)||(n=[n]),(n||[]).forEach((function(n){n in l?e.push(n):console.error({methods:t,key:n,error:"监听的值未注册，请检查init方法"})})),e}(n,e),u=o.map((function(n){var t=l[n].key;return v[t].status==i.FULFILLED?Promise.resolve:p[t]}));return Promise.race([Promise.all(u),m[r].promise])}var E=function(t,r){var o=this,u=w();!function(t,r,o){var u=e;o&&n(o),u((function(n){t(n),null==r||r(n)}))}((function(n){}),(function(n){return s(o,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,k(r,u,"onCustomLaunch")];case 1:return e.sent(),t(n),[3,3];case 2:return e.sent(),[3,3];case 3:return[2]}}))}))}),(function(){g(r,u)}))},D=function(n,e){var o=this,u=w();!function(n,e,o){var u=r;o&&t(o),u((function(t){n(t),null==e||e(t)}))}((function(n){}),(function(t){return s(o,void 0,void 0,(function(){return f(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,k(e,u,"onCustomLoad")];case 1:return r.sent(),n(t),[3,3];case 2:return r.sent(),[3,3];case 3:return[2]}}))}))}),(function(){g(e,u)}))},U=function(n,t){var e=this,r=w();b((function(n){}),(function(){return s(e,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,k(t,r,"onCustomShow")];case 1:return e.sent(),n(),[3,3];case 2:return e.sent(),[3,3];case 3:return[2]}}))}))}),(function(){g(t,r)}))},F=function(n,e){var r=this,o=w();!function(n,e,r){n(),null==e||e(),r&&u(r),r&&t(r)}((function(n){}),(function(){return s(r,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,k(e,o,"onCustomCreated")];case 1:return t.sent(),n(),[3,3];case 2:return t.sent(),[3,3];case 3:return[2]}}))}))}),(function(){g(e,o)}))},P=function(n,t){var e=this,r=w();!function(n,t,e){var r=c;e&&u(e),r((function(){n(),null==t||t()}))}((function(n){}),(function(){return s(e,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,k(t,r,"onCustomMounted")];case 1:return e.sent(),n(),[3,3];case 2:return e.sent(),[3,3];case 3:return[2]}}))}))}),(function(){g(t,r)}))},j=function(n,t){var e=this,r=w();b((function(n){}),(function(){return s(e,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,k(t,r,"onCustomReady")];case 1:return e.sent(),n(),[3,3];case 2:return e.sent(),[3,3];case 3:return[2]}}))}))}),(function(){g(t,r)}))};export{x as init,p as keyPromise,F as onCustomCreated,E as onCustomLaunch,D as onCustomLoad,P as onCustomMounted,j as onCustomReady,U as onCustomShow,v as promiseMap,d as proxyData,l as watchObj};
